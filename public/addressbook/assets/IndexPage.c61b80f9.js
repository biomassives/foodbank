import{c as M,a as h,h as P,j as G,az as le,W as w,v as ne,i as se,e as T,l as re,k as de,y as j,r as k,o as W,P as A,M as ie,A as m,N as $,E as l,D as b,Q as E,B as S,C as v,S as D,T as R,aA as ue,aB as q,F as I,z as Y,V as ce,w as L,X as fe,_ as Z,K as N,f as X,G as V,O as Q,U as F}from"./index.86fc262c.js";import{f as me,h as pe,b as H}from"./use-quasar.00d2e197.js";import{Q as ve,a as ge,b as U,c as K,d as J,e as ye}from"./QSeparator.76404330.js";import{Q as z}from"./QCardSection.128d10df.js";import{Q as ee}from"./QCardActions.83788304.js";import{f as te,C as ae,Q as oe}from"./ClosePopup.0a1e2cc5.js";import{Q as be}from"./QPage.3923ee58.js";import{E as Ce}from"./EntryModal.12acf72d.js";import{Q as O}from"./QInput.00be970d.js";import"./QSpace.0e75fa89.js";import"./QToggle.5286364e.js";var he=M({name:"QBtnGroup",props:{unelevated:Boolean,outline:Boolean,flat:Boolean,rounded:Boolean,square:Boolean,push:Boolean,stretch:Boolean,glossy:Boolean,spread:Boolean},setup(e,{slots:t}){const r=h(()=>{const y=["unelevated","outline","flat","rounded","square","push","stretch","glossy"].filter(p=>e[p]===!0).map(p=>`q-btn-group--${p}`).join(" ");return`q-btn-group row no-wrap${y.length!==0?" "+y:""}`+(e.spread===!0?" q-btn-group--spread":" inline")});return()=>P("div",{class:r.value},G(t.default))}}),ke=M({name:"QBtnToggle",props:{...me,modelValue:{required:!0},options:{type:Array,required:!0,validator:e=>e.every(t=>("label"in t||"icon"in t||"slot"in t)&&"value"in t)},color:String,textColor:String,toggleColor:{type:String,default:"primary"},toggleTextColor:String,outline:Boolean,flat:Boolean,unelevated:Boolean,rounded:Boolean,push:Boolean,glossy:Boolean,size:String,padding:String,noCaps:Boolean,noWrap:Boolean,dense:Boolean,readonly:Boolean,disable:Boolean,stack:Boolean,stretch:Boolean,spread:Boolean,clearable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","clear","click"],setup(e,{slots:t,emit:r}){const y=h(()=>e.options.find(d=>d.value===e.modelValue)!==void 0),p=h(()=>({type:"hidden",name:e.name,value:e.modelValue})),C=pe(p),c=h(()=>le(e)),o=h(()=>({rounded:e.rounded,dense:e.dense,...c.value})),g=h(()=>e.options.map((d,f)=>{const{attrs:B,value:n,slot:i,...a}=d;return{slot:i,props:{key:f,"aria-pressed":n===e.modelValue?"true":"false",...B,...a,...o.value,disable:e.disable===!0||a.disable===!0,color:n===e.modelValue?s(a,"toggleColor"):s(a,"color"),textColor:n===e.modelValue?s(a,"toggleTextColor"):s(a,"textColor"),noCaps:s(a,"noCaps")===!0,noWrap:s(a,"noWrap")===!0,size:s(a,"size"),padding:s(a,"padding"),ripple:s(a,"ripple"),stack:s(a,"stack")===!0,stretch:s(a,"stretch")===!0,onClick(x){_(n,d,x)}}}}));function _(d,f,B){e.readonly!==!0&&(e.modelValue===d?e.clearable===!0&&(r("update:modelValue",null,null),r("clear")):r("update:modelValue",d,f),r("click",B))}function s(d,f){return d[f]===void 0?e[f]:d[f]}function u(){const d=g.value.map(f=>P(w,f.props,f.slot!==void 0?t[f.slot]:void 0));return e.name!==void 0&&e.disable!==!0&&y.value===!0&&C(d,"push"),ne(t.default,d)}return()=>P(he,{class:"q-btn-toggle",...c.value,rounded:e.rounded,stretch:e.stretch,glossy:e.glossy,spread:e.spread},u)}});const _e={position:{type:String,default:"bottom-right",validator:e=>["top-right","top-left","bottom-right","bottom-left","top","right","bottom","left"].includes(e)},offset:{type:Array,validator:e=>e.length===2},expand:Boolean};function $e(){const{props:e,proxy:{$q:t}}=de(),r=se(re,T);if(r===T)return console.error("QPageSticky needs to be child of QLayout"),T;const y=h(()=>{const u=e.position;return{top:u.indexOf("top")!==-1,right:u.indexOf("right")!==-1,bottom:u.indexOf("bottom")!==-1,left:u.indexOf("left")!==-1,vertical:u==="top"||u==="bottom",horizontal:u==="left"||u==="right"}}),p=h(()=>r.header.offset),C=h(()=>r.right.offset),c=h(()=>r.footer.offset),o=h(()=>r.left.offset),g=h(()=>{let u=0,d=0;const f=y.value,B=t.lang.rtl===!0?-1:1;f.top===!0&&p.value!==0?d=`${p.value}px`:f.bottom===!0&&c.value!==0&&(d=`${-c.value}px`),f.left===!0&&o.value!==0?u=`${B*o.value}px`:f.right===!0&&C.value!==0&&(u=`${-B*C.value}px`);const n={transform:`translate(${u}, ${d})`};return e.offset&&(n.margin=`${e.offset[1]}px ${e.offset[0]}px`),f.vertical===!0?(o.value!==0&&(n[t.lang.rtl===!0?"right":"left"]=`${o.value}px`),C.value!==0&&(n[t.lang.rtl===!0?"left":"right"]=`${C.value}px`)):f.horizontal===!0&&(p.value!==0&&(n.top=`${p.value}px`),c.value!==0&&(n.bottom=`${c.value}px`)),n}),_=h(()=>`q-page-sticky row flex-center fixed-${e.position} q-page-sticky--${e.expand===!0?"expand":"shrink"}`);function s(u){const d=G(u.default);return P("div",{class:_.value,style:g.value},e.expand===!0?d:[P("div",d)])}return{$layout:r,getStickyContent:s}}var we=M({name:"QPageSticky",props:_e,setup(e,{slots:t}){const{getStickyContent:r}=$e();return()=>r(t)}});const Be={class:"q-pa-md"},Ie={key:0,class:"text-center q-pa-lg"},Se={key:1,class:"text-center q-pa-xl text-grey-7"},xe={key:1,class:"row q-gutter-xs"},Ve=j({__name:"QueueList",setup(e){const t=H(),r=k([]),y=k(!0),p=o=>o==="pending"?"orange-8":o==="claimed"?"blue-7":"green-9",C=async()=>{const{data:o}=await A.from("boulder_pickups").select("*").order("created_at",{ascending:!1});r.value=o||[],y.value=!1},c=async o=>{const{data:{user:g}}=await A.auth.getUser();if(!g)return t.notify("Please login first");const{error:_}=await A.from("boulder_pickups").update({claimed_by:g.id,status:"claimed"}).eq("id",o.id);_||(t.notify({message:"Task claimed! Notifying community...",color:"positive"}),C())};return W(()=>{C(),A.channel("public:boulder_pickups").on("postgres_changes",{event:"*",schema:"public",table:"boulder_pickups"},C).subscribe()}),(o,g)=>{const _=ie("q-spinner-eco");return m(),$("div",Be,[y.value?(m(),$("div",Ie,[l(_,{color:"green-8",size:"3em"}),g[0]||(g[0]=b("div",{class:"text-brown-9 q-mt-sm"},"Loading community queue...",-1))])):r.value.length===0?(m(),$("div",Se,[l(E,{name:"Park",size:"lg"}),g[1]||(g[1]=b("div",{class:"text-h6"},"The queue is clear!",-1))])):(m(),S(ve,{key:2,bordered:"",separator:"",class:"rounded-borders bg-white"},{default:v(()=>[(m(!0),$(D,null,R(r.value,s=>(m(),S(ge,{key:s.id,class:"q-py-md"},{default:v(()=>[l(U,{avatar:""},{default:v(()=>[l(ue,{icon:s.status==="pending"?"wait_for_confirm":"local_shipping",color:p(s.status),"text-color":"white"},null,8,["icon","color"])]),_:2},1024),l(U,null,{default:v(()=>[l(K,{class:"text-weight-bold"},{default:v(()=>[q(I(s.description),1)]),_:2},1024),l(K,{caption:""},{default:v(()=>[q(I(s.location),1)]),_:2},1024)]),_:2},1024),l(U,{side:""},{default:v(()=>[s.status==="pending"?(m(),S(w,{key:0,label:"Claim",color:"green-8",unelevated:"",onClick:u=>c(s)},null,8,["onClick"])):o.isClaimer(s)?(m(),$("div",xe,[l(w,{flat:"",round:"",icon:"undo",color:"orange-9",onClick:u=>o.handleUnclaim(s)},null,8,["onClick"]),l(w,{flat:"",round:"",icon:"done_all",color:"green",onClick:u=>o.handleComplete(s)},null,8,["onClick"])])):(m(),S(J,{key:2,color:p(s.status)},{default:v(()=>[q(I(s.status),1)]),_:2},1032,["color"]))]),_:2},1024)]),_:2},1024))),128))]),_:1}))])}}}),Qe=j({name:"AddressModal",props:{cardState:{required:!0,type:Boolean},addressInfo:{required:!1,type:Object}},emits:["update:cardState"],setup(e,{emit:t}){var B;const r=Y(),y=k(!1),p=ce(e,"cardState"),C=k((B=e.addressInfo)==null?void 0:B.id),c=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,o=k(e.addressInfo?e.addressInfo.name.first:""),g=k(e.addressInfo?e.addressInfo.name.last:""),_=k(e.addressInfo?e.addressInfo.email:""),s=k(e.addressInfo?e.addressInfo.phone:""),u=H(),d=()=>{u.notify({type:"negative",position:"top",message:"Please check all details for validation purposes."})},f=async()=>{if(!fe({firstName:o.value,lastName:g.value,email:_.value,phone:s.value}))return d();const n=o.value[0].toUpperCase().concat(o.value.slice(1)),i=g.value[0].toUpperCase().concat(g.value.slice(1)),a={id:"",name:{first:n,last:i},email:_.value,phone:s.value};if(C.value){const x=C.value;a.id=x,await r.updateData({addressId:x,address:a})}else await r.addData(a);t("update:cardState",!1)};return L(p,n=>{y.value=n}),L(y,n=>{o.value=e.addressInfo?e.addressInfo.name.first:"",g.value=e.addressInfo?e.addressInfo.name.last:"",_.value=e.addressInfo?e.addressInfo.email:"",s.value=e.addressInfo?e.addressInfo.phone:"",t("update:cardState",n)}),{internalCard:y,firstName:o,lastName:g,email:_,phone:s,prompt:k(!1),emailPattern:c,nameRules:[n=>n&&n.length>0||"Please type Name",n=>n&&n.length>=3||"Please enter 3 or more",n=>n&&/^[a-z]+$/gi.test(n)||"String only"],emailRules:[n=>n&&c.test(n)||"Invalid email format"],phoneRules:[()=>s.value.replace(/[-()\s]/g,"").length>=10||"Invalid phone number format"],saveAddress:f}}}),qe={class:"text-h6"},Pe={class:"row"},Ae={class:"row"};function Ne(e,t,r,y,p,C){return m(),S(oe,{modelValue:e.internalCard,"onUpdate:modelValue":t[8]||(t[8]=c=>e.internalCard=c)},{default:v(()=>[l(te,{class:"my-card"},{default:v(()=>[l(z,{class:"flex justify-content-center bg-grey-8 text-white align-center"},{default:v(()=>[b("div",qe,I(e.addressInfo?"Address Edit":"New Address"),1)]),_:1}),l(ye),l(z,{class:"q-pt-none"},{default:v(()=>{var c;return[b("div",Pe,[l(O,{class:"q-ma-sm",style:{width:"200px"},dense:"",modelValue:e.firstName,"onUpdate:modelValue":t[0]||(t[0]=o=>e.firstName=o),readonly:!!((c=e.addressInfo)!=null&&c.id),label:"First Name",rules:e.nameRules,autofocus:"",clearable:"",onKeyup:t[1]||(t[1]=N(o=>e.prompt=!1,["enter"]))},null,8,["modelValue","readonly","rules"]),l(O,{class:"q-ma-sm",style:{width:"200px"},dense:"",modelValue:e.lastName,"onUpdate:modelValue":t[2]||(t[2]=o=>e.lastName=o),label:"Last Name",rules:e.nameRules,clearable:"",onKeyup:t[3]||(t[3]=N(o=>e.prompt=!1,["enter"]))},null,8,["modelValue","rules"])]),b("div",Ae,[l(O,{class:"q-ma-sm",style:{width:"200px"},dense:"",modelValue:e.email,"onUpdate:modelValue":t[4]||(t[4]=o=>e.email=o),label:"E-mail",rules:e.emailRules,clearable:"",onKeyup:t[5]||(t[5]=N(o=>e.prompt=!1,["enter"]))},null,8,["modelValue","rules"]),l(O,{class:"q-ma-sm",style:{width:"200px"},dense:"",modelValue:e.phone,"onUpdate:modelValue":t[6]||(t[6]=o=>e.phone=o),label:"Phone Number",mask:"(###) ### - ####",rules:e.phoneRules,clearable:"",onKeyup:t[7]||(t[7]=N(o=>e.prompt=!1,["enter"]))},null,8,["modelValue","rules"])])]}),_:1}),l(ee,{class:"text-grey-8 justify-end"},{default:v(()=>[X(l(w,{flat:"",label:"Cancel"},null,512),[[ae]]),l(w,{flat:"",label:"Save address",onClick:e.saveAddress},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}var Oe=Z(Qe,[["render",Ne]]);const De={key:0,class:"toggle-bar"},ze={class:"index-content"},Te={class:"loc-text"},Ue={class:"loc-name"},Ee={class:"loc-type"},Re={class:"contact-text"},Me={class:"contact-name"},je={class:"contact-meta"},Le={class:"contact-meta"},Fe={key:1,class:"contact-actions"},Ke={key:0,class:"hint-row"},Ge={key:1,class:"nudge-row"},We=j({__name:"IndexPage",setup(e){const t=Y(),r=k("directory"),y=k(!1),p=k(!1),C=k(void 0),c=k(!1),o=k(null),g=[{id:"loc-a",name:"Pickup Point A",type:"Pickup",icon:"location_on",color:"#69f0ae"},{id:"loc-b",name:"Pickup Point B",type:"Pickup",icon:"location_on",color:"#82b1ff"},{id:"loc-c",name:"Pickup Point C",type:"Pickup",icon:"location_on",color:"#ce93d8"},{id:"loc-pantry",name:"Pantry",type:"Storage",icon:"store",color:"#fdd835"}],_=[{id:"seed-mgr",name:{first:"Pantry",last:"Manager"},email:"manager@wardfoodpantry.org",phone:"(555) 100-2000",seed:!0,badge:"MANAGER",badgeColor:"amber",dotColor:"#fdd835"},{id:"seed-dev",name:{first:"Software",last:"Contact"},email:"dev@worldbridger.org",phone:"(555) 100-2001",seed:!0,badge:"SUPPORT",badgeColor:"blue-4",dotColor:"#82b1ff"}],s=h(()=>t.getData),u=h(()=>{const n=s.value.map(i=>({...i,seed:!1,badge:null,badgeColor:"",dotColor:"#69f0ae"}));return[..._,...n]});function d(n){C.value=n,p.value=!0}function f(n){o.value=n,c.value=!0}async function B(){o.value&&(await t.deleteData(o.value.id),o.value=null,c.value=!1)}return W(async()=>{await t.loadData(),await t.loadEntries(),t.localMode||await t.fetchUserRole()}),(n,i)=>(m(),S(be,{class:"index-page"},{default:v(()=>[V(t).userOrgId||V(t).localMode?(m(),$("div",De,[l(ke,{modelValue:r.value,"onUpdate:modelValue":i[0]||(i[0]=a=>r.value=a),flat:"","no-caps":"",class:"view-toggle",options:[{label:"DIRECTORY",value:"directory"},{label:"QUEUE",value:"queue"}]},null,8,["modelValue"])])):Q("",!0),b("div",ze,[r.value==="directory"?(m(),$(D,{key:0},[i[6]||(i[6]=b("div",{class:"section-label"},"LOCATIONS",-1)),(m(),$(D,null,R(g,a=>b("div",{key:a.id,class:"loc-row"},[l(E,{name:a.icon,size:"18px",style:F({color:a.color})},null,8,["name","style"]),b("div",Te,[b("div",Ue,I(a.name),1),b("div",Ee,I(a.type),1)])])),64)),i[7]||(i[7]=b("div",{class:"section-label q-mt-sm"},"DIRECTORY",-1)),(m(!0),$(D,null,R(u.value,a=>(m(),$("div",{key:a.id,class:"contact-row"},[b("div",{class:"contact-dot",style:F({background:a.dotColor})},null,4),b("div",Re,[b("div",Me,I(a.name.first)+" "+I(a.name.last),1),b("div",je,I(a.email),1),b("div",Le,I(a.phone),1)]),a.badge?(m(),S(J,{key:0,outline:"",color:a.badgeColor,label:a.badge,class:"contact-badge"},null,8,["color","label"])):Q("",!0),!a.seed&&V(t).canEdit?(m(),$("div",Fe,[l(w,{flat:"",dense:"",round:"",icon:"edit",size:"xs",color:"grey-5",onClick:x=>d(a)},null,8,["onClick"]),l(w,{flat:"",dense:"",round:"",icon:"delete",size:"xs",color:"red-4",onClick:x=>f(a)},null,8,["onClick"])])):Q("",!0)]))),128)),s.value.length===0?(m(),$("div",Ke,[l(E,{name:"add_circle_outline",size:"14px"}),i[5]||(i[5]=b("span",null,"Tap + to add contacts, needs, offerings and more",-1))])):Q("",!0),!V(t).userOrgId&&!V(t).localMode?(m(),$("div",Ge,[l(w,{flat:"","no-caps":"",dense:"",label:"Sign in or create a pantry",icon:"arrow_forward",to:"/login",class:"nudge-btn"})])):Q("",!0)],64)):(m(),S(Ve,{key:1}))]),l(we,{position:"bottom-right",offset:[18,18]},{default:v(()=>[l(w,{fab:"",icon:"add",class:"fab-btn",onClick:i[1]||(i[1]=a=>y.value=!0)})]),_:1}),l(Ce,{"card-state":y.value,"onUpdate:cardState":i[2]||(i[2]=a=>y.value=a)},null,8,["card-state"]),l(Oe,{"card-state":p.value,"onUpdate:cardState":i[3]||(i[3]=a=>p.value=a),"address-info":C.value},null,8,["card-state","address-info"]),l(oe,{modelValue:c.value,"onUpdate:modelValue":i[4]||(i[4]=a=>c.value=a)},{default:v(()=>[l(te,{class:"confirm-card"},{default:v(()=>[l(z,{class:"confirm-header"},{default:v(()=>[...i[8]||(i[8]=[q("DELETE CONTACT",-1)])]),_:1}),l(z,{class:"confirm-body"},{default:v(()=>[q(I(o.value?o.value.name.first+" "+o.value.name.last:""),1)]),_:1}),l(ee,{align:"right",class:"confirm-actions"},{default:v(()=>[X(l(w,{flat:"","no-caps":"",label:"Cancel",class:"confirm-cancel"},null,512),[[ae]]),l(w,{flat:"","no-caps":"",label:"Delete",class:"confirm-delete",onClick:B})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});var st=Z(We,[["__scopeId","data-v-5b1a12b6"]]);export{st as default};

import{c as Y,d as j,h as K,ad as D,y as M,L as W,z as F,r as y,A as B,B as G,C as A,D as e,F as p,G as t,H as E,E as i,Q as L,f as P,I as $,R as N,N as R,W as x,aB as z,P as C}from"./index.86fc262c.js";import{Q as V}from"./QInput.00be970d.js";import{Q as J}from"./QPage.3923ee58.js";import{b as X}from"./use-quasar.00d2e197.js";import{u as Z}from"./index.e3b3a4de.js";var Q=Y({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(S,{slots:w,emit:k}){let g=!1,l,r,f=null,h=null,c,v;function m(){l==null||l(),l=null,g=!1,f!==null&&(clearTimeout(f),f=null),h!==null&&(clearTimeout(h),h=null),r==null||r.removeEventListener("transitionend",c),c=null}function I(a,d,u){d!==void 0&&(a.style.height=`${d}px`),a.style.transition=`height ${S.duration}ms cubic-bezier(.25, .8, .50, 1)`,g=!0,l=u}function T(a,d){a.style.overflowY=null,a.style.height=null,a.style.transition=null,m(),d!==v&&k(d)}function q(a,d){let u=0;r=a,g===!0?(m(),u=a.offsetHeight===a.scrollHeight?0:void 0):(v="hide",a.style.overflowY="hidden"),I(a,u,d),f=setTimeout(()=>{f=null,a.style.height=`${a.scrollHeight}px`,c=b=>{h=null,(Object(b)!==b||b.target===a)&&T(a,"show")},a.addEventListener("transitionend",c),h=setTimeout(c,S.duration*1.1)},100)}function U(a,d){let u;r=a,g===!0?m():(v="show",a.style.overflowY="hidden",u=a.scrollHeight),I(a,u,d),f=setTimeout(()=>{f=null,a.style.height=0,c=b=>{h=null,(Object(b)!==b||b.target===a)&&T(a,"hide")},a.addEventListener("transitionend",c),h=setTimeout(c,S.duration*1.1)},100)}return j(()=>{g===!0&&m()}),()=>K(D,{css:!1,appear:S.appear,onEnter:q,onLeave:U},w.default)}});const ee={class:"onboard-wrap"},oe={class:"onboard-brand"},le={class:"onboard-brand-title"},te={class:"onboard-brand-tagline"},ae={class:"onboard-hero"},ne={class:"onboard-hero-content"},ie={class:"onboard-hero-icon"},se={key:0},re={key:1},de={class:"onboard-hero"},ue={class:"onboard-hero-content"},be={class:"onboard-hero-icon"},pe={class:"onboard-hero"},ge={class:"onboard-hero-content"},he={class:"onboard-hero-icon"},ce={class:"onboard-body-hint q-mt-xs q-mb-none"},fe={class:"onboard-body-hint q-mb-sm",style:{"line-height":"1.5"}},me={class:"row q-gutter-sm q-mt-xs"},ye={class:"onboard-body-hint q-mt-xs q-mb-none"},ve={class:"onboard-about"},Se=M({__name:"OnboardPage",setup(S){const w=W(),k=F(),g=X(),{t:l}=Z(),r=y(null);function f(s){r.value!==s&&(r.value=s)}const h=y(""),c=y(""),v=y(!1),m=y(!1);async function I(){m.value=!0;const{error:s}=await C.auth.signInWithOtp({phone:h.value});s?g.notify({color:"negative",message:s.message}):v.value=!0,m.value=!1}async function T(){m.value=!0;const{error:s}=await C.auth.verifyOtp({phone:h.value,token:c.value,type:"sms"});s?g.notify({color:"negative",message:s.message}):(await k.fetchUserRole(),w.push("/")),m.value=!1}const q=y(""),U=y(!1);async function a(){U.value=!0;try{const{data:s,error:o}=await C.from("invites").select("*").eq("code",q.value.toUpperCase()).eq("is_used",!1).single();if(o||!s)throw new Error("Invalid or used invite code.");const{data:{user:n}}=await C.auth.getUser();if(!n)throw new Error("Please sign in first.");await C.from("profiles").update({org_id:s.org_id,role:"editor",has_invite:!0}).eq("id",n.id),await C.from("invites").update({is_used:!0,used_by:n.id}).eq("id",s.id),await k.fetchUserRole(),g.notify({color:"positive",message:"Welcome to the community!"}),w.push("/")}catch(s){g.notify({color:"negative",message:s.message})}finally{U.value=!1}}const d=y(""),u=y(""),b=y("");function H(){localStorage.setItem("localMode","true"),localStorage.setItem("siloInitiator","true"),k.$patch({role:"admin"}),g.notify({color:"positive",message:"You're in! Everything saves right here on your device."}),w.push("/")}function O(){const s="https://github.com/biomassives/foodbank",o="VITE_SUPABASE_URL,VITE_SUPABASE_ANON_KEY",n=`https://vercel.com/new/clone?repository-url=${encodeURIComponent(s)}&env=${encodeURIComponent(o)}`;window.open(n,"_blank")}function _(){!u.value.trim()||!b.value.trim()||(localStorage.setItem("customSupabaseUrl",u.value.trim()),localStorage.setItem("customSupabaseKey",b.value.trim()),d.value.trim()&&localStorage.setItem("pantryName",d.value.trim()),localStorage.setItem("localMode","true"),localStorage.setItem("siloInitiator","true"),k.$patch({role:"admin"}),g.notify({color:"positive",message:"Connected! Your pantry is ready."}),w.push("/"))}return(s,o)=>(B(),G(J,{class:"onboard-page"},{default:A(()=>[e("div",ee,[e("div",oe,[e("div",le,p(t(l).app.name),1),e("div",te,p(t(l).app.tagline),1)]),e("div",{class:E(["onboard-card theme-sunset q-mb-md",{expanded:r.value==="login"}]),onClick:o[4]||(o[4]=n=>f("login"))},[e("div",ae,[o[13]||(o[13]=e("svg",{class:"hero-art",viewBox:"0 0 460 180",preserveAspectRatio:"none"},[e("circle",{cx:"230",cy:"52",r:"40",fill:"none",stroke:"rgba(255,255,255,0.18)","stroke-width":"2","stroke-dasharray":"6 4"}),e("circle",{cx:"230",cy:"52",r:"28",fill:"rgba(255,255,255,0.1)"}),e("circle",{cx:"230",cy:"52",r:"14",fill:"rgba(255,255,255,0.07)"}),e("line",{x1:"0",y1:"100",x2:"460",y2:"100",stroke:"rgba(255,255,255,0.1)","stroke-width":"1"}),e("rect",{x:"0",y:"135",width:"460",height:"45",fill:"rgba(0,0,0,0.12)"}),e("rect",{x:"10",y:"112",width:"55",height:"68",fill:"rgba(0,0,0,0.32)"}),e("rect",{x:"70",y:"98",width:"40",height:"82",fill:"rgba(0,0,0,0.28)"}),e("rect",{x:"118",y:"118",width:"62",height:"62",fill:"rgba(0,0,0,0.22)"}),e("rect",{x:"192",y:"104",width:"48",height:"76",fill:"rgba(0,0,0,0.3)"}),e("rect",{x:"248",y:"122",width:"58",height:"58",fill:"rgba(0,0,0,0.2)"}),e("rect",{x:"314",y:"108",width:"44",height:"72",fill:"rgba(0,0,0,0.26)"}),e("rect",{x:"364",y:"120",width:"72",height:"60",fill:"rgba(0,0,0,0.18)"}),e("rect",{x:"30",y:"92",width:"5",height:"20",fill:"rgba(0,0,0,0.35)"}),e("rect",{x:"85",y:"78",width:"4",height:"20",fill:"rgba(0,0,0,0.3)"}),e("rect",{x:"208",y:"86",width:"5",height:"18",fill:"rgba(0,0,0,0.32)"}),e("rect",{x:"330",y:"90",width:"4",height:"18",fill:"rgba(0,0,0,0.28)"}),e("rect",{x:"20",y:"125",width:"4",height:"4",fill:"rgba(255,255,255,0.08)"}),e("rect",{x:"30",y:"125",width:"4",height:"4",fill:"rgba(255,255,255,0.06)"}),e("rect",{x:"20",y:"135",width:"4",height:"4",fill:"rgba(255,255,255,0.05)"}),e("rect",{x:"40",y:"135",width:"4",height:"4",fill:"rgba(255,255,255,0.07)"}),e("rect",{x:"200",y:"115",width:"4",height:"4",fill:"rgba(255,255,255,0.06)"}),e("rect",{x:"210",y:"115",width:"4",height:"4",fill:"rgba(255,255,255,0.05)"}),e("rect",{x:"200",y:"125",width:"4",height:"4",fill:"rgba(255,255,255,0.07)"}),e("rect",{x:"220",y:"125",width:"4",height:"4",fill:"rgba(255,255,255,0.04)"}),e("rect",{x:"320",y:"118",width:"4",height:"4",fill:"rgba(255,255,255,0.06)"}),e("rect",{x:"330",y:"128",width:"4",height:"4",fill:"rgba(255,255,255,0.05)"}),e("rect",{x:"380",y:"130",width:"4",height:"4",fill:"rgba(255,255,255,0.06)"}),e("rect",{x:"392",y:"130",width:"4",height:"4",fill:"rgba(255,255,255,0.04)"})],-1)),o[14]||(o[14]=e("span",{class:"hero-reg",style:{top:"8px",left:"10px"}},"+",-1)),o[15]||(o[15]=e("span",{class:"hero-reg",style:{top:"8px",right:"10px"}},"+",-1)),o[16]||(o[16]=e("span",{class:"hero-reg",style:{bottom:"8px",left:"10px"}},"+",-1)),o[17]||(o[17]=e("span",{class:"hero-reg",style:{bottom:"8px",right:"10px"}},"+",-1)),e("div",ne,[e("div",ie,[i(L,{name:"home",size:"26px",color:"white"})]),e("h2",null,p(t(l).onboard.loginTitle),1),e("p",null,p(t(l).onboard.loginSub),1)])]),i(Q,null,{default:A(()=>[P(e("div",{class:"onboard-body",onClick:o[3]||(o[3]=N(()=>{},["stop"]))},[v.value?(B(),R("div",re,[i(V,{modelValue:c.value,"onUpdate:modelValue":o[1]||(o[1]=n=>c.value=n),filled:"",dense:"",dark:"",label:t(l).onboard.codeLabel,mask:"######",color:"deep-orange-4"},null,8,["modelValue","label"]),i(x,{label:t(l).onboard.verify,class:"onboard-btn full-width q-mt-md",onClick:T,loading:m.value,"no-caps":""},null,8,["label","loading"]),i(x,{flat:"",dense:"","no-caps":"",label:t(l).onboard.back,class:"full-width q-mt-xs",style:{color:"var(--wb-text-muted)"},onClick:o[2]||(o[2]=n=>v.value=!1)},null,8,["label"])])):(B(),R("div",se,[i(V,{modelValue:h.value,"onUpdate:modelValue":o[0]||(o[0]=n=>h.value=n),filled:"",dense:"",dark:"",label:t(l).onboard.phoneLabel,mask:"+############",hint:t(l).onboard.phoneHint,color:"deep-orange-4"},null,8,["modelValue","label","hint"]),i(x,{label:t(l).onboard.sendCode,class:"onboard-btn full-width q-mt-md",onClick:I,loading:m.value,"no-caps":""},null,8,["label","loading"])]))],512),[[$,r.value==="login"]])]),_:1})],2),e("div",{class:E(["onboard-card theme-forest q-mb-md",{expanded:r.value==="invite"}]),onClick:o[7]||(o[7]=n=>f("invite"))},[e("div",de,[o[18]||(o[18]=e("svg",{class:"hero-art",viewBox:"0 0 460 180",preserveAspectRatio:"none"},[e("polygon",{points:"50,180 80,55 110,180",fill:"rgba(0,0,0,0.12)"}),e("polygon",{points:"140,180 175,40 210,180",fill:"rgba(0,0,0,0.1)"}),e("polygon",{points:"250,180 282,48 314,180",fill:"rgba(0,0,0,0.11)"}),e("polygon",{points:"350,180 378,52 406,180",fill:"rgba(0,0,0,0.09)"}),e("polygon",{points:"0,180 38,72 76,180",fill:"rgba(0,0,0,0.24)"}),e("polygon",{points:"85,180 128,45 171,180",fill:"rgba(0,0,0,0.2)"}),e("polygon",{points:"180,180 220,60 260,180",fill:"rgba(0,0,0,0.22)"}),e("polygon",{points:"275,180 318,50 361,180",fill:"rgba(0,0,0,0.18)"}),e("polygon",{points:"370,180 405,65 440,180",fill:"rgba(0,0,0,0.2)"}),e("rect",{x:"33",y:"140",width:"6",height:"40",fill:"rgba(0,0,0,0.3)"}),e("rect",{x:"124",y:"130",width:"6",height:"50",fill:"rgba(0,0,0,0.28)"}),e("rect",{x:"216",y:"135",width:"6",height:"45",fill:"rgba(0,0,0,0.25)"}),e("rect",{x:"314",y:"128",width:"6",height:"52",fill:"rgba(0,0,0,0.27)"}),e("rect",{x:"401",y:"132",width:"6",height:"48",fill:"rgba(0,0,0,0.22)"}),e("rect",{x:"0",y:"165",width:"460",height:"15",fill:"rgba(0,0,0,0.1)"}),e("text",{x:"95",y:"35",fill:"rgba(255,255,255,0.08)","font-size":"14","font-family":"serif"},"\u2605"),e("text",{x:"310",y:"30",fill:"rgba(255,255,255,0.06)","font-size":"10","font-family":"serif"},"\u2605"),e("text",{x:"420",y:"42",fill:"rgba(255,255,255,0.07)","font-size":"8","font-family":"serif"},"\u2605")],-1)),o[19]||(o[19]=e("span",{class:"hero-reg",style:{top:"8px",left:"10px"}},"+",-1)),o[20]||(o[20]=e("span",{class:"hero-reg",style:{top:"8px",right:"10px"}},"+",-1)),o[21]||(o[21]=e("span",{class:"hero-reg",style:{bottom:"8px",left:"10px"}},"+",-1)),o[22]||(o[22]=e("span",{class:"hero-reg",style:{bottom:"8px",right:"10px"}},"+",-1)),e("div",ue,[e("div",be,[i(L,{name:"group_add",size:"26px",color:"white"})]),e("h2",null,p(t(l).onboard.joinTitle),1),e("p",null,p(t(l).onboard.joinSub),1)])]),i(Q,null,{default:A(()=>[P(e("div",{class:"onboard-body",onClick:o[6]||(o[6]=N(()=>{},["stop"]))},[i(V,{modelValue:q.value,"onUpdate:modelValue":o[5]||(o[5]=n=>q.value=n),filled:"",dense:"",dark:"",label:t(l).onboard.inviteLabel,mask:"AAAAAA",hint:t(l).onboard.inviteHint,color:"green-4"},null,8,["modelValue","label","hint"]),i(x,{label:t(l).onboard.joinBtn,class:"onboard-btn full-width q-mt-md",onClick:a,loading:U.value,"no-caps":""},null,8,["label","loading"])],512),[[$,r.value==="invite"]])]),_:1})],2),e("div",{class:E(["onboard-card theme-mountain q-mb-md",{expanded:r.value==="create"}]),onClick:o[12]||(o[12]=n=>f("create"))},[e("div",pe,[o[23]||(o[23]=e("svg",{class:"hero-art",viewBox:"0 0 460 180",preserveAspectRatio:"none"},[e("polygon",{points:"0,180 65,62 130,180",fill:"rgba(0,0,0,0.1)"}),e("polygon",{points:"110,180 195,42 280,180",fill:"rgba(0,0,0,0.08)"}),e("polygon",{points:"240,180 335,55 430,180",fill:"rgba(0,0,0,0.09)"}),e("polygon",{points:"0,180 45,85 90,135 145,58 200,180",fill:"rgba(0,0,0,0.22)"}),e("polygon",{points:"170,180 230,78 295,128 355,52 460,180",fill:"rgba(0,0,0,0.18)"}),e("polygon",{points:"45,85 56,100 34,100",fill:"rgba(255,255,255,0.14)"}),e("polygon",{points:"145,58 158,76 132,76",fill:"rgba(255,255,255,0.12)"}),e("polygon",{points:"230,78 243,94 217,94",fill:"rgba(255,255,255,0.1)"}),e("polygon",{points:"355,52 370,72 340,72",fill:"rgba(255,255,255,0.12)"}),e("line",{x1:"355",y1:"52",x2:"355",y2:"35",stroke:"rgba(255,255,255,0.2)","stroke-width":"1.5"}),e("polygon",{points:"355,35 370,40 355,45",fill:"rgba(255,255,255,0.15)"}),e("line",{x1:"50",y1:"88",x2:"85",y2:"130",stroke:"rgba(255,255,255,0.04)","stroke-width":"1"}),e("line",{x1:"148",y1:"62",x2:"190",y2:"150",stroke:"rgba(255,255,255,0.03)","stroke-width":"1"}),e("line",{x1:"358",y1:"56",x2:"420",y2:"145",stroke:"rgba(255,255,255,0.03)","stroke-width":"1"})],-1)),o[24]||(o[24]=e("span",{class:"hero-reg",style:{top:"8px",left:"10px"}},"+",-1)),o[25]||(o[25]=e("span",{class:"hero-reg",style:{top:"8px",right:"10px"}},"+",-1)),o[26]||(o[26]=e("span",{class:"hero-reg",style:{bottom:"8px",left:"10px"}},"+",-1)),o[27]||(o[27]=e("span",{class:"hero-reg",style:{bottom:"8px",right:"10px"}},"+",-1)),e("div",ge,[e("div",he,[i(L,{name:"add_business",size:"26px",color:"white"})]),e("h2",null,p(t(l).onboard.createTitle),1),e("p",null,p(t(l).onboard.createSub),1)])]),i(Q,null,{default:A(()=>[P(e("div",{class:"onboard-body",onClick:o[11]||(o[11]=N(()=>{},["stop"]))},[i(x,{label:t(l).onboard.startLocal,icon:"play_arrow",class:"onboard-btn full-width",onClick:H,"no-caps":""},null,8,["label"]),e("p",ce,p(t(l).onboard.startLocalHint),1),o[29]||(o[29]=e("div",{class:"onboard-body-divider"},null,-1)),e("p",fe,[z(p(t(l).onboard.cloudPrompt),1),o[28]||(o[28]=e("br",null,null,-1)),z(" "+p(t(l).onboard.cloudPromptSub),1)]),i(V,{modelValue:d.value,"onUpdate:modelValue":o[8]||(o[8]=n=>d.value=n),filled:"",dense:"",dark:"",label:t(l).onboard.pantryName,placeholder:t(l).onboard.pantryPlaceholder,color:"blue-4",class:"q-mb-sm"},null,8,["modelValue","label","placeholder"]),i(V,{modelValue:u.value,"onUpdate:modelValue":o[9]||(o[9]=n=>u.value=n),filled:"",dense:"",dark:"",label:t(l).onboard.supabaseUrl,placeholder:t(l).onboard.supabaseUrlPlaceholder,color:"blue-4",class:"q-mb-sm"},null,8,["modelValue","label","placeholder"]),i(V,{modelValue:b.value,"onUpdate:modelValue":o[10]||(o[10]=n=>b.value=n),filled:"",dense:"",dark:"",label:t(l).onboard.supabaseKey,placeholder:t(l).onboard.supabaseKeyPlaceholder,color:"blue-4",class:"q-mb-sm"},null,8,["modelValue","label","placeholder"]),e("div",me,[i(x,{label:t(l).onboard.deployVercel,icon:"rocket_launch",class:"onboard-btn col",onClick:O,"no-caps":"",dense:""},null,8,["label"]),i(x,{label:t(l).onboard.saveConnect,icon:"link",class:"onboard-btn col",onClick:_,disable:!u.value||!b.value,"no-caps":"",dense:""},null,8,["label","disable"])]),e("p",ye,p(t(l).onboard.deployHint),1)],512),[[$,r.value==="create"]])]),_:1})],2),e("div",ve,p(t(l).app.about),1)])]),_:1}))}});export{Se as default};
